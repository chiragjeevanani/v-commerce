import{q as Q,Q as v,b as J,r as p,R as K,j as e,Z as W,N as m,ai as X,B as g,o as $,l as ee,V as C}from"./index-BpRMWdVM.js";import{C as N,a as w,b as z,c as P,d as R,e as se}from"./card-CyVSnPS_.js";import{L as i}from"./label-XkaMJijg.js";import{T as ae,a as te,b as E,c as L}from"./tabs-BcXXqXRW.js";import{S as re}from"./switch-CLUz6FRI.js";import{S as oe}from"./separator-DF53nTyw.js";import{S as ne}from"./shield-yPfgfNer.js";import{S as _}from"./save-CsQWEPm2.js";import{L as V}from"./lock-GPowaNo4.js";import{E as ie}from"./eye-off-BsVmLTHl.js";import{E as ce}from"./eye-D0NRzLWa.js";import{C as le}from"./circle-check-Dj_7B0TO.js";import"./index-C_G7Jul-.js";import"./index-D0VtG131.js";const de=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],pe=Q("key",de),h={getStoreSettings:async()=>{try{const a=await v.get("/content/get-content",{params:{contentType:"store_settings"}});return a.data?a.data.content:null}catch(a){return console.error("Fetch Store Settings Error:",a),null}},updateStoreSettings:async a=>{try{return(await v.put("/content/update-content",{contentType:"store_settings",content:a})).data}catch(r){throw console.error("Update Store Settings Error:",r),r}},uploadStoreLogo:async a=>{try{const r=new FormData;return r.append("image",a),(await v.post("/upload/settings/store/logo",r,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(r){throw console.error("Upload Store Logo Error:",r),r}},getRazorpaySettings:async()=>{try{return(await v.get("/razorpay/settings")).data?.data||null}catch(a){return console.error("Fetch Razorpay Settings Error:",a),null}},updateRazorpaySettings:async a=>{try{return(await v.put("/razorpay/settings",a)).data}catch(r){throw console.error("Update Razorpay Settings Error:",r),r}},testRazorpayConnection:async()=>{try{return(await v.post("/razorpay/test-connection")).data}catch(a){throw console.error("Test Razorpay Connection Error:",a),a}}},Pe=()=>{const{toast:a}=J(),[r,I]=p.useState("account"),[me,ue]=p.useState(!1),[x,n]=p.useState(!1),[u,y]=p.useState({storeName:"",storeUrl:"",storeDescription:"",storeLogo:""}),[f,S]=p.useState({fullName:"",email:"",avatar:""}),U=K.useRef(null),F=K.useRef(null),[l,b]=p.useState({oldPassword:"",newPassword:"",confirmPassword:""}),[t,j]=p.useState({keyId:"",keySecret:"",isConfigured:!1,isEnabled:!1}),[k,T]=p.useState(!1),[D,A]=p.useState(!1);p.useEffect(()=>{(async()=>{try{const o=C.getCurrentUser();o&&S({fullName:o.fullName||"",email:o.email||"",avatar:o.avatar||""});const c=await h.getStoreSettings();y(c?{storeName:c.storeName||"",storeUrl:c.storeUrl||"",storeDescription:c.storeDescription||"",storeLogo:c.storeLogo||""}:{storeName:"V-Commerce",storeUrl:"vcommerce.com",storeDescription:"Modern Shopping Experience for Lifestyle & Electronics."});const d=await h.getRazorpaySettings();d&&j({keyId:d.keyId||"",keySecret:d.keySecret||"",isConfigured:d.isConfigured||!1,isEnabled:d.isEnabled!==void 0?d.isEnabled:!1})}catch(o){console.error("Failed to load settings:",o),a({title:"Error",description:"Failed to load settings data.",variant:"destructive"})}})()},[]);const q=async()=>{A(!0);try{const s=await h.testRazorpayConnection();a({title:"Connection Successful",description:s.message||"Razorpay API is responding correctly."})}catch(s){a({title:"Connection Failed",description:s.response?.data?.message||"Failed to connect to Razorpay. Please check your credentials.",variant:"destructive"})}finally{A(!1)}},B=async()=>{if(!t.keyId||!t.keySecret){a({title:"Validation Error",description:"Both Key ID and Key Secret are required.",variant:"destructive"});return}n(!0);try{await h.updateRazorpaySettings({keyId:t.keyId,keySecret:t.keySecret,isEnabled:t.isEnabled}),a({title:"Razorpay Settings Updated",description:"Your Razorpay credentials have been saved successfully."});const s=await h.getRazorpaySettings();s&&j({keyId:s.keyId||"",keySecret:s.keySecret||"",isConfigured:s.isConfigured||!1,isEnabled:s.isEnabled!==void 0?s.isEnabled:!1}),T(!1)}catch(s){a({title:"Error",description:s.response?.data?.message||"Failed to update Razorpay settings.",variant:"destructive"})}finally{n(!1)}},G=async s=>{if(s&&(!t.keyId||!t.keySecret)){a({title:"Configuration Required",description:"Please configure Razorpay credentials before enabling.",variant:"destructive"});return}if(j({...t,isEnabled:s}),t.isConfigured)try{await h.updateRazorpaySettings({keyId:t.keyId,keySecret:t.keySecret,isEnabled:s}),a({title:s?"Razorpay Enabled":"Razorpay Disabled",description:s?"Razorpay payment gateway is now active.":"Razorpay payment gateway has been disabled."})}catch{j({...t,isEnabled:!s}),a({title:"Error",description:"Failed to update Razorpay status.",variant:"destructive"})}},Y=async()=>{n(!0);try{await h.updateStoreSettings(u),a({title:"Store Settings Updated",description:"Your store details have been saved."})}catch{a({title:"Error",description:"Failed to update store settings.",variant:"destructive"})}finally{n(!1)}},M=async()=>{n(!0);try{await C.updateProfile(f),a({title:"Profile Updated",description:"Your admin details have been saved."})}catch(s){a({title:"Error",description:s.message||"Failed to update profile.",variant:"destructive"})}finally{n(!1)}},Z=async()=>{if(l.newPassword!==l.confirmPassword){a({title:"Password Mismatch",description:"New passwords do not match.",variant:"destructive"});return}n(!0);try{await C.changePassword({oldPassword:l.oldPassword,newPassword:l.newPassword}),a({title:"Password Changed",description:"Your password has been updated successfully."}),b({oldPassword:"",newPassword:"",confirmPassword:""})}catch(s){a({title:"Error",description:s.message||"Failed to change password.",variant:"destructive"})}finally{n(!1)}},H=async s=>{const o=s.target.files[0];if(o){n(!0);try{const c=await h.uploadStoreLogo(o);y(d=>({...d,storeLogo:c.data.storeLogo})),a({title:"Logo Uploaded",description:"Store logo updated successfully."})}catch{a({title:"Upload Failed",description:"Could not upload logo.",variant:"destructive"})}finally{n(!1)}}},O=async s=>{const o=s.target.files[0];if(o){n(!0);try{const c=await C.uploadAvatar(o);S(d=>({...d,avatar:c.data.avatar})),a({title:"Avatar Uploaded",description:"Profile picture updated successfully."})}catch{a({title:"Upload Failed",description:"Could not upload avatar.",variant:"destructive"})}finally{n(!1)}}};return e.jsxs("div",{className:"space-y-6 pb-10 max-w-5xl",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Settings"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Configure your store, API connections, and account preferences."})]}),e.jsxs(ae,{value:r,onValueChange:I,className:"space-y-6",children:[e.jsxs(te,{className:"bg-muted/50 p-1 border",children:[e.jsxs(E,{value:"account",className:"gap-2",children:[e.jsx(W,{className:"h-4 w-4"})," Account Settings"]}),e.jsxs(E,{value:"security",className:"gap-2",children:[e.jsx(ne,{className:"h-4 w-4"})," Security"]}),e.jsxs(E,{value:"api",className:"gap-2",children:[e.jsx(pe,{className:"h-4 w-4"})," API & Tools"]})]}),e.jsx(L,{value:"account",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"font-bold",children:"Store Profile"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"General information about your ecommerce platform."})]}),e.jsxs(N,{className:"md:col-span-2",children:[e.jsxs(w,{className:"space-y-6 pt-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"store-name",children:"Store Name"}),e.jsx(m,{id:"store-name",value:u.storeName,onChange:s=>y({...u,storeName:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"store-url",children:"Store URL"}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"flex items-center px-3 bg-muted border border-r-0 rounded-l-md text-xs font-medium",children:"https://"}),e.jsx(m,{id:"store-url",className:"rounded-l-none",value:u.storeUrl,onChange:s=>y({...u,storeUrl:s.target.value})})]})]}),e.jsxs("div",{className:"space-y-2 sm:col-span-2",children:[e.jsx(i,{htmlFor:"store-desc",children:"Store Description"}),e.jsx(m,{id:"store-desc",value:u.storeDescription,onChange:s=>y({...u,storeDescription:s.target.value})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(i,{children:"Store Logo"}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"h-20 w-20 rounded-xl border-2 border-dashed flex items-center justify-center bg-muted overflow-hidden",children:u.storeLogo?e.jsx("img",{src:u.storeLogo,alt:"Store Logo",className:"h-full w-full object-cover"}):e.jsx(X,{className:"h-8 w-8 text-muted-foreground opacity-20"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"file",ref:U,className:"hidden",accept:"image/*",onChange:H}),e.jsx(g,{variant:"outline",size:"sm",className:"gap-2",onClick:()=>U.current?.click(),disabled:x,children:"Change Logo"}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Recommended size: 512x512px (PNG, SVG)"})]})]})]})]}),e.jsx(z,{className:"border-t bg-muted/20 justify-end py-3",children:e.jsxs(g,{className:"gap-2",onClick:Y,disabled:x,children:[e.jsx(_,{className:"h-4 w-4"})," Save Store Settings"]})})]}),e.jsx(oe,{className:"col-span-1 md:col-span-3 my-4"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"font-bold",children:"Administrator Profile"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Update your personal account details."})]}),e.jsxs(N,{className:"md:col-span-2",children:[e.jsxs(w,{className:"pt-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-6 pb-4",children:[e.jsx("div",{className:"h-24 w-24 rounded-full border-4 border-muted overflow-hidden",children:e.jsx("img",{src:f.avatar||"https://github.com/shadcn.png",className:"h-full w-full object-cover"})}),e.jsx("input",{type:"file",ref:F,className:"hidden",accept:"image/*",onChange:O}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>F.current?.click(),disabled:x,children:"Change Avatar"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Full Name"}),e.jsx(m,{value:f.fullName,onChange:s=>S({...f,fullName:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Email Address"}),e.jsx(m,{value:f.email,onChange:s=>S({...f,email:s.target.value})})]})]})]}),e.jsx(z,{className:"border-t py-3 justify-end gap-2",children:e.jsx(g,{onClick:M,disabled:x,children:"Update Profile"})})]})]})}),e.jsx(L,{value:"security",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"font-bold",children:"Security & Login"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Protect your administrative account."})]}),e.jsxs("div",{className:"md:col-span-2 space-y-6",children:[e.jsxs(N,{children:[e.jsx(P,{children:e.jsxs(R,{className:"text-lg flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4"})," Change Password"]})}),e.jsxs(w,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Current Password"}),e.jsx(m,{type:"password",value:l.oldPassword,onChange:s=>b({...l,oldPassword:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"New Password"}),e.jsx(m,{type:"password",value:l.newPassword,onChange:s=>b({...l,newPassword:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Confirm New Password"}),e.jsx(m,{type:"password",value:l.confirmPassword,onChange:s=>b({...l,confirmPassword:s.target.value})})]}),e.jsx(g,{className:"w-full",onClick:Z,disabled:x,children:"Update Password"})]})]}),e.jsxs(N,{className:"border-red-100 dark:border-red-900/30",children:[e.jsx(P,{children:e.jsx(R,{className:"text-red-600 text-lg",children:"Danger Zone"})}),e.jsx(w,{children:e.jsxs("div",{className:"flex items-center justify-between border-t pt-4 border-red-50 dark:border-red-900/10",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("p",{className:"text-sm font-bold",children:"Resign as Admin"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This will revoke all your management access."})]}),e.jsx(g,{variant:"destructive",size:"sm",children:"Deactivate Account"})]})})]})]})]})}),e.jsx(L,{value:"api",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"font-bold",children:"Supplier API Connections"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage keys for your dropshipping network integrations."})]}),e.jsx("div",{className:"md:col-span-2 space-y-6",children:e.jsxs(N,{children:[e.jsxs(P,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:e.jsx($,{className:"h-5 w-5 text-blue-700 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx(R,{className:"text-lg",children:"Razorpay Payment Gateway"}),e.jsx(se,{children:"Payment processing API integration"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{htmlFor:"razorpay-toggle",className:"text-sm text-muted-foreground cursor-pointer",children:t.isEnabled?"Enabled":"Disabled"}),e.jsx(re,{id:"razorpay-toggle",checked:t.isEnabled,onCheckedChange:G,disabled:!t.isConfigured})]}),e.jsx(ee,{className:t.isConfigured?"bg-green-500":"bg-gray-400",children:t.isConfigured?"Connected":"Not Configured"})]})]}),e.jsxs(w,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"razorpay-key-id",children:"Razorpay Key ID"}),e.jsx(m,{id:"razorpay-key-id",type:"text",value:t.keyId,onChange:s=>j({...t,keyId:s.target.value}),placeholder:"rzp_test_xxxxxxxxxxxxx",className:"font-mono"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"razorpay-key-secret",children:"Razorpay Key Secret"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{id:"razorpay-key-secret",type:k?"text":"password",value:t.keySecret,onChange:s=>j({...t,keySecret:s.target.value}),placeholder:t.isConfigured?"••••••••••••••••••••":"Enter your Razorpay Key Secret",className:"font-mono"}),e.jsx(g,{variant:"outline",size:"icon",onClick:()=>T(!k),type:"button",children:k?e.jsx(ie,{className:"h-4 w-4"}):e.jsx(ce,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/40 rounded-lg text-xs",children:[e.jsx("div",{className:"flex items-center gap-2",children:t.isConfigured?e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{children:"Credentials configured"})]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:"Enter your Razorpay credentials"})]})}),e.jsx(g,{variant:"ghost",size:"sm",className:"text-xs h-8 text-primary font-bold",onClick:q,disabled:D||!t.keyId||!t.keySecret,children:D?"Testing...":"Test Connection"})]})]}),e.jsx(z,{className:"border-t bg-muted/20 justify-end py-3",children:e.jsxs(g,{className:"gap-2",onClick:B,disabled:x||!t.keyId||!t.keySecret,children:[e.jsx(_,{className:"h-4 w-4"})," Save Razorpay Settings"]})})]})})]})})]})]})};export{Pe as default};
