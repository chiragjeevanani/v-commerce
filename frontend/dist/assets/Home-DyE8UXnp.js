import{r as i,j as e,A as Q,m as p,L as h,B as R,C as U,a as X}from"./index-BpRMWdVM.js";import{p as F}from"./products.service-CJOEitO_.js";import{P as K}from"./ProductCard-B-Z6UzWT.js";import{S as W}from"./SkeletonCard-CdR-J2Np.js";import{A as I}from"./arrow-right-TmxnumzM.js";import{L as ee}from"./layout-grid-BP90qunA.js";import{Z as H}from"./zap-BHonP-a9.js";import"./card-CyVSnPS_.js";import"./eye-D0NRzLWa.js";let O=!1;const pe=()=>{const[f,j]=i.useState(0),[d,q]=i.useState([]),[re,V]=i.useState(!0),[A,B]=i.useState([]),[C,N]=i.useState([]),[k,T]=i.useState(!0),[L,J]=i.useState(1),[m,S]=i.useState(!0),[x,z]=i.useState(!1),_=i.useRef(null),y=i.useRef(!1),$=i.useRef(0),P=1500;i.useEffect(()=>{(async()=>{try{const o=await(await fetch("https://api.vcommerce.shop/api/v1/hero-banners")).json();o.success&&o.data&&q(o.data)}catch(a){console.error("Failed to fetch banners:",a)}finally{V(!1)}})()},[]),i.useEffect(()=>{let t=!0;return(async()=>{O||T(!0);try{const[o,r]=await Promise.all([F.getSupplierProducts({page:1,size:20}),F.fetchCategories()]);if(console.log("Categories Result:",r),console.log("Categories Type:",typeof r),console.log("Is Array:",Array.isArray(r)),t){if(o?.products){const g=o.products;B(g);const c=1,s=o.totalPages,u=s?c<s:g.length>=20;S(u),console.log(`[InitialLoad] Loaded ${g.length} products, Page ${c}/${s||"?"}, hasMore: ${u}`)}r&&Array.isArray(r)?(console.log("Setting categories (direct array):",r.length),N(r)):r&&r.data&&Array.isArray(r.data)?(console.log("Setting categories (nested data):",r.data.length),N(r.data)):r&&r.length!==void 0?(console.log("Setting categories (array-like):",r.length),N(Array.from(r))):(console.warn("Categories data format unexpected:",r),N([]))}}catch(o){console.error("Failed to fetch data:",o),console.error("Error details:",o.response||o.message)}finally{t&&(T(!1),O=!0)}})(),()=>{t=!1}},[]),i.useEffect(()=>{if(d.length===0)return;const t=setInterval(()=>{j(a=>(a+1)%d.length)},5e3);return()=>clearInterval(t)},[d.length]);const v=i.useCallback(async()=>{if(y.current){console.log("[LoadMore] Already loading, skipping...");return}if(!m){console.log("[LoadMore] No more products available");return}const t=Date.now(),a=t-$.current;if(a<P){const r=P-a;console.log(`[LoadMore] Rate limiting: waiting ${r}ms before next request`),setTimeout(()=>{!y.current&&m&&v()},r);return}y.current=!0,$.current=t,z(!0);const o=L+1;console.log(`[LoadMore] Loading page ${o}...`);try{const r=await F.getSupplierProducts({page:o,size:20,skipCache:!0});if(console.log(`[LoadMore] Response received for page ${o}:`,r?.products?.length||0,"products"),console.log("[LoadMore] Response totalPages:",r?.totalPages),r?.products&&r.products.length>0&&console.log("[LoadMore] First product from API:",{id:r.products[0].id,pid:r.products[0].pid,name:r.products[0].name?.substring(0,50)}),r?.products&&r.products.length>0){B(s=>{s.length>0&&console.log("[LoadMore] Existing product IDs (first 5):",s.slice(0,5).map(l=>({id:l.id,pid:l.pid}))),console.log("[LoadMore] New product IDs (first 5):",r.products.slice(0,5).map(l=>({id:l.id,pid:l.pid})));const u=new Set,E=new Set;s.forEach(l=>{l.id&&u.add(String(l.id)),l.pid&&E.add(String(l.pid))});const M=r.products.filter(l=>{const b=l.id,w=l.pid,n=b&&u.has(String(b)),Z=w&&E.has(String(w));return n||Z?!1:(b&&u.add(String(b)),w&&E.add(String(w)),!0)});if(M.length===0&&r.products.length>0){console.warn(`[LoadMore] âš ï¸ All ${r.products.length} products from page ${o} are duplicates!`),console.warn("[LoadMore] ðŸ” Debugging - API Response Product IDs:",r.products.map(n=>({id:n.id,pid:n.pid,name:n.name?.substring(0,30)}))),console.warn("[LoadMore] ðŸ” Debugging - Existing Product IDs:",s.map(n=>({id:n.id,pid:n.pid,name:n.name?.substring(0,30)})));const l=r.products.map(n=>String(n.id||n.pid)).filter(Boolean),b=s.map(n=>String(n.id||n.pid)).filter(Boolean);if(l.every(n=>b.includes(n))&&(console.error(`[LoadMore] âŒ CONFIRMED: CJ API is returning EXACTLY the same products for page ${o}!`),console.error("[LoadMore] This is a CJ API issue - they are ignoring the pageNum parameter.")),o>2)return console.warn(`[LoadMore] â›” Stopping infinite scroll - CJ API returning duplicates (page ${o})`),S(!1),s}const D=[...s,...M];return console.log(`[LoadMore] âœ… Added ${M.length} new products (${r.products.length-M.length} duplicates filtered), Total: ${D.length}`),D}),J(o);const g=r.totalPages,c=g?o<g:r.products.length>=20;S(c),console.log(`[LoadMore] Page ${o}/${g||"?"}, Has more products: ${c}`)}else console.log("[LoadMore] No more products available"),S(!1)}catch(r){console.error("[LoadMore] Failed to load more products:",r)}finally{z(!1),y.current=!1}},[m,L]);i.useEffect(()=>{if(!_.current)return;const t=new IntersectionObserver(o=>{const r=o[0],c=Date.now()-$.current,s=c>=P;r.isIntersecting&&!x&&m&&!y.current&&s?(console.log("[IntersectionObserver] âœ… Triggering loadMoreProducts"),v()):r.isIntersecting&&!s&&console.log(`[IntersectionObserver] Rate limited: ${P-c}ms remaining`)},{root:null,rootMargin:"300px",threshold:.1}),a=_.current;return t.observe(a),()=>{a&&t.unobserve(a)}},[v,x,m]),i.useEffect(()=>{const t=()=>{if(y.current||!m||x)return;const r=window.pageYOffset||document.documentElement.scrollTop,g=window.innerHeight,c=document.documentElement.scrollHeight,s=r+g,u=c-400;console.log("[ScrollHandler] Scroll check:",{scrollPosition:s,threshold:u,documentHeight:c,shouldLoad:s>=u}),s>=u&&(console.log("[ScrollHandler] âœ… Triggering loadMoreProducts"),v())};let a=!1;const o=()=>{a||(window.requestAnimationFrame(()=>{t(),a=!1}),a=!0)};return window.addEventListener("scroll",o,{passive:!0}),setTimeout(t,100),()=>window.removeEventListener("scroll",o)},[v,x,m]);const Y=()=>{d.length!==0&&j(t=>(t+1)%d.length)},G=()=>{d.length!==0&&j(t=>(t-1+d.length)%d.length)};return e.jsxs("div",{className:"flex flex-col min-h-screen gap-10 pb-10",children:[d.length>0&&e.jsxs("section",{className:"relative h-[600px] w-full overflow-hidden bg-background",children:[e.jsx(Q,{mode:"wait",children:e.jsxs(p.div,{initial:{opacity:0,scale:1.1},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.8,ease:"easeOut"},className:"absolute inset-0",children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center transition-transform duration-[10s] ease-linear scale-110",style:{backgroundImage:`url(${d[f].image})`,backgroundColor:"hsl(var(--muted))",animation:"kenburns 20s infinite alternate"},children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-background/90 via-background/40 to-transparent"})}),e.jsx("div",{className:"relative container h-full flex flex-col justify-center items-start p-6 md:p-12",children:e.jsxs(p.div,{initial:{x:-50,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.6},className:"max-w-2xl",children:[e.jsx(p.span,{className:"inline-block px-3 py-1 rounded-full bg-primary/10 text-primary text-xs font-bold tracking-widest uppercase mb-4",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4},children:"New Arrival"}),e.jsx(p.h1,{className:"text-5xl md:text-7xl font-bold mb-6 text-foreground leading-tight",children:d[f].title.split(" ").map((t,a)=>e.jsx(p.span,{className:"inline-block mr-4",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5+a*.1},children:t},a))}),e.jsx(p.p,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.8},className:"text-lg md:text-xl mb-10 text-muted-foreground max-w-lg leading-relaxed",children:d[f].description}),e.jsx(p.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:1},className:"flex gap-4",children:e.jsx(h,{to:"/shop",children:e.jsxs(R,{size:"lg",className:"text-lg px-8 py-7 rounded-full shadow-lg hover:shadow-primary/20 transition-all active:scale-95 group",children:[d[f].cta,e.jsx(I,{className:"ml-2 h-5 w-5 transition-transform group-hover:translate-x-1"})]})})})]})})]},f)}),e.jsxs("div",{className:"absolute bottom-8 right-12 flex gap-4 z-10",children:[e.jsx(R,{variant:"outline",size:"icon",className:"rounded-full bg-background/20 backdrop-blur-md border-white/20 hover:bg-primary hover:text-primary-foreground transition-all duration-300",onClick:G,children:e.jsx(U,{className:"h-6 w-6"})}),e.jsx(R,{variant:"outline",size:"icon",className:"rounded-full bg-background/20 backdrop-blur-md border-white/20 hover:bg-primary hover:text-primary-foreground transition-all duration-300",onClick:Y,children:e.jsx(X,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"absolute bottom-8 left-12 flex gap-2 z-10",children:d.map((t,a)=>e.jsx("button",{onClick:()=>j(a),className:`h-1.5 transition-all duration-500 rounded-full ${a===f?"w-8 bg-primary":"w-2 bg-primary/20"}`},a))})]}),e.jsxs("section",{className:"container relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 -translate-y-1/2 translate-x-1/2 w-[600px] h-[600px] bg-primary/5 rounded-full blur-[140px] pointer-events-none opacity-0 dark:opacity-100 transition-opacity duration-1000"}),e.jsx("div",{className:"absolute bottom-0 left-0 translate-y-1/2 -translate-x-1/2 w-[600px] h-[600px] bg-indigo-500/5 rounded-full blur-[140px] pointer-events-none opacity-0 dark:opacity-100 transition-opacity duration-1000"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between mb-16 gap-8 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsxs("div",{className:"relative group/title-icon",children:[e.jsx("div",{className:"absolute inset-0 bg-primary blur-2xl opacity-20 group-hover/title-icon:opacity-40 transition-opacity"}),e.jsx("div",{className:"relative h-16 w-16 rounded-2xl bg-primary flex items-center justify-center text-primary-foreground shadow-2xl shadow-primary/40 ring-1 ring-white/20",children:e.jsx(ee,{className:"h-8 w-8"})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:"text-4xl md:text-6xl font-black tracking-tighter bg-clip-text text-transparent bg-gradient-to-r from-foreground via-foreground/90 to-foreground/70 leading-tight",children:"Browse Categories"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-1 w-12 bg-gradient-to-r from-primary to-transparent rounded-full"}),e.jsx("p",{className:"text-primary text-xs uppercase font-black tracking-[0.3em] opacity-90",children:"Discover by subcategory"})]})]})]}),e.jsxs(h,{to:"/shop",className:"group flex items-center gap-4 text-sm font-black uppercase tracking-[0.2em] text-primary hover:text-foreground transition-all",children:[e.jsxs("span",{className:"relative",children:["Explore All Collection",e.jsx("span",{className:"absolute -bottom-1.5 left-0 w-0 h-0.5 bg-primary transition-all group-hover:w-full"})]}),e.jsx("div",{className:"flex items-center justify-center h-10 w-10 rounded-full bg-primary/10 border border-primary/20 group-hover:bg-primary group-hover:text-primary-foreground group-hover:scale-110 transition-all duration-300 shadow-lg group-hover:shadow-primary/30",children:e.jsx(I,{className:"h-5 w-5 transition-transform group-hover:translate-x-1"})})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10 relative z-10 min-h-[600px]",children:k?Array.from({length:6}).map((t,a)=>e.jsx("div",{className:"h-72 rounded-[3.5rem] bg-muted/40 animate-pulse border border-border/50"},a)):C&&C.length>0?C.slice(0,6).map((t,a)=>e.jsxs(p.div,{initial:{opacity:0,y:40},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:a*.1,type:"spring",stiffness:80,damping:18},className:"group relative overflow-hidden bg-gradient-to-br from-card/60 to-card/20 dark:from-card/90 dark:to-background/40 backdrop-blur-3xl border border-border/40 dark:border-white/10 rounded-[3.5rem] p-10 transition-all duration-500 hover:shadow-[0_40px_100px_-20px_rgba(0,0,0,0.2)] dark:hover:shadow-[0_30px_100px_-20px_rgba(var(--primary),0.15)] hover:-translate-y-3 cursor-pointer",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.03] via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-700"}),e.jsx("div",{className:"absolute -top-24 -right-24 h-64 w-64 bg-primary/10 rounded-full blur-[80px] pointer-events-none group-hover:bg-primary/20 transition-all duration-700"}),e.jsx("div",{className:"absolute top-0 left-12 right-12 h-[1px] bg-gradient-to-r from-transparent via-white/10 dark:via-white/20 to-transparent"}),e.jsxs("div",{className:"flex justify-between items-start mb-10 relative z-10",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(h,{to:`/shop?category=${t.categoryFirstId||t.id}`,children:e.jsxs("h3",{className:"text-3xl font-black text-foreground group-hover:text-primary transition-all duration-300 uppercase italic tracking-tighter leading-[0.85] flex flex-col",children:[e.jsx("span",{className:"text-primary/50 text-[10px] italic normal-case tracking-[0.2em] mb-2 font-black",children:"PREMIUM SERIES"}),t.categoryFirstName||t.name]})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-[2px] w-6 bg-primary/40 rounded-full group-hover:w-10 group-hover:bg-primary transition-all"}),e.jsxs("p",{className:"text-[10px] text-muted-foreground font-black tracking-[0.2em] uppercase opacity-60 group-hover:opacity-100 transition-opacity",children:[t.categoryFirstList?.length||0," Subcategories"]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-primary blur-xl opacity-0 group-hover:opacity-30 transition-opacity duration-500"}),e.jsx("div",{className:"relative h-16 w-16 rounded-2xl bg-secondary/50 dark:bg-white/5 backdrop-blur-2xl flex items-center justify-center group-hover:bg-primary group-hover:text-primary-foreground group-hover:shadow-[0_0_30px_rgba(var(--primary),0.4)] transition-all duration-700 border border-border/50 dark:border-white/10 ring-1 ring-white/5",children:e.jsx(H,{className:"h-8 w-8 fill-current"})})]})]}),e.jsx("div",{className:"flex flex-wrap gap-3 relative z-10",children:t.categoryFirstList&&t.categoryFirstList.length>0?e.jsxs(e.Fragment,{children:[t.categoryFirstList.slice(0,5).map((o,r)=>e.jsx(h,{to:`/shop?category=${o.categorySecondId||o.id}`,className:"px-5 py-2.5 rounded-2xl bg-secondary/20 dark:bg-white/[0.03] border border-border/40 dark:border-white/5 text-[12px] font-bold text-muted-foreground hover:bg-primary hover:text-primary-foreground hover:border-transparent hover:shadow-2xl hover:shadow-primary/20 transition-all duration-500 backdrop-blur-md",children:o.categorySecondName||o.name},o.categorySecondId||o.id||r)),t.categoryFirstList.length>5&&e.jsxs(h,{to:`/shop?category=${t.categoryFirstId||t.id}`,className:"px-4 py-2 text-[12px] font-black text-primary hover:text-foreground transition-all flex items-center gap-2 group/more",children:[e.jsxs("span",{children:["+",t.categoryFirstList.length-5," More"]}),e.jsx(I,{className:"h-3.5 w-3.5 transition-transform group-hover/more:translate-x-1.5"})]})]}):e.jsx(h,{to:`/shop?category=${t.categoryFirstId||t.id}`,className:"px-5 py-2.5 rounded-2xl bg-secondary/20 dark:bg-white/[0.03] border border-border/40 dark:border-white/5 text-[12px] font-bold text-muted-foreground hover:bg-primary hover:text-primary-foreground hover:border-transparent hover:shadow-2xl hover:shadow-primary/20 transition-all duration-500 backdrop-blur-md",children:"Explore Products"})}),e.jsx("div",{className:"absolute bottom-0 left-[15%] right-[15%] h-[2px] bg-gradient-to-r from-transparent via-primary/50 to-transparent opacity-0 group-hover:opacity-100 transition-all duration-1000 blur-[0.5px]"})]},t.categoryFirstId||t.id||a)):Array.from({length:6}).map((t,a)=>e.jsxs(p.div,{initial:{opacity:0,y:40},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:a*.1,type:"spring",stiffness:80,damping:18},className:"group relative overflow-hidden bg-gradient-to-br from-card/60 to-card/20 dark:from-card/90 dark:to-background/40 backdrop-blur-3xl border border-border/40 dark:border-white/10 rounded-[3.5rem] p-10 transition-all duration-500 hover:shadow-[0_40px_100px_-20px_rgba(0,0,0,0.2)] dark:hover:shadow-[0_30px_100px_-20px_rgba(var(--primary),0.15)] hover:-translate-y-3 cursor-pointer",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/[0.03] via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-700"}),e.jsx("div",{className:"absolute -top-24 -right-24 h-64 w-64 bg-primary/10 rounded-full blur-[80px] pointer-events-none group-hover:bg-primary/20 transition-all duration-700"}),e.jsx("div",{className:"absolute top-0 left-12 right-12 h-[1px] bg-gradient-to-r from-transparent via-white/10 dark:via-white/20 to-transparent"}),e.jsxs("div",{className:"flex justify-between items-start mb-10 relative z-10",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(h,{to:"/shop",children:e.jsxs("h3",{className:"text-3xl font-black text-foreground group-hover:text-primary transition-all duration-300 uppercase italic tracking-tighter leading-[0.85] flex flex-col",children:[e.jsx("span",{className:"text-primary/50 text-[10px] italic normal-case tracking-[0.2em] mb-2 font-black",children:"COMING SOON"}),"Category ",a+1]})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-[2px] w-6 bg-primary/40 rounded-full group-hover:w-10 group-hover:bg-primary transition-all"}),e.jsx("p",{className:"text-[10px] text-muted-foreground font-black tracking-[0.2em] uppercase opacity-60 group-hover:opacity-100 transition-opacity",children:"Loading Categories"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-primary blur-xl opacity-0 group-hover:opacity-30 transition-opacity duration-500"}),e.jsx("div",{className:"relative h-16 w-16 rounded-2xl bg-secondary/50 dark:bg-white/5 backdrop-blur-2xl flex items-center justify-center group-hover:bg-primary group-hover:text-primary-foreground group-hover:shadow-[0_0_30px_rgba(var(--primary),0.4)] transition-all duration-700 border border-border/50 dark:border-white/10 ring-1 ring-white/5",children:e.jsx(H,{className:"h-8 w-8 fill-current"})})]})]}),e.jsx("div",{className:"flex flex-wrap gap-3 relative z-10",children:e.jsx(h,{to:"/shop",className:"px-5 py-2.5 rounded-2xl bg-secondary/20 dark:bg-white/[0.03] border border-border/40 dark:border-white/5 text-[12px] font-bold text-muted-foreground hover:bg-primary hover:text-primary-foreground hover:border-transparent hover:shadow-2xl hover:shadow-primary/20 transition-all duration-500 backdrop-blur-md",children:"Explore Shop"})}),e.jsx("div",{className:"absolute bottom-0 left-[15%] right-[15%] h-[2px] bg-gradient-to-r from-transparent via-primary/50 to-transparent opacity-0 group-hover:opacity-100 transition-all duration-1000 blur-[0.5px]"})]},a))})]}),e.jsxs("section",{className:"container py-12 mb-12",children:[e.jsxs("div",{className:"flex items-end justify-between mb-10",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Featured Products"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Quality products selected just for you."})]}),e.jsxs(h,{to:"/shop",className:"group flex items-center gap-2 text-sm font-bold uppercase tracking-widest text-primary",children:["View All ",e.jsx(I,{className:"h-4 w-4 transition-transform group-hover:translate-x-1"})]})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-3 md:gap-4 lg:gap-5",children:k?Array.from({length:10}).map((t,a)=>e.jsx(W,{},a)):A.map((t,a)=>e.jsx(p.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0,margin:"-50px"},transition:{delay:a%20*.05,duration:.4},children:e.jsx(K,{product:t})},`${t.pid||t.id}-${a}`))},k?"loading":"loaded"),e.jsx("div",{ref:_,className:"h-20 w-full flex items-center justify-center",children:m&&!x&&e.jsx("div",{className:"text-xs text-muted-foreground opacity-50",children:"Scroll for more products..."})}),x&&e.jsx("div",{className:"flex justify-center mt-8",children:e.jsxs("div",{className:"flex items-center gap-3 text-muted-foreground",children:[e.jsx("div",{className:"h-6 w-6 border-2 border-primary border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-sm font-medium",children:"Loading more products..."})]})}),!k&&!x&&!m&&A.length>0&&L>1&&e.jsxs(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mt-8 space-y-2",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:"You've reached the end of our collection"}),L<=3&&e.jsxs("p",{className:"text-xs text-muted-foreground/70",children:["Showing ",A.length," products"]})]})]})]})};export{pe as default};
