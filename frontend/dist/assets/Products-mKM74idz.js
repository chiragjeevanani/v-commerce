import{c as P,r as t,j as e,B as l,O as q,E as H,T as j,ac as J,ab as W,G as K,A as X,m as Z,C as ee,a as se}from"./index-DEuHK2Q3.js";import{p as S}from"./products.service-CixRTqH0.js";import{D as te,a as ae,b as re,c as ie,d as le,e as ne}from"./dialog-D8W0a-XQ.js";import{L as V}from"./label-C88YU_qe.js";import{S as ce}from"./slider-B90v_FId.js";import{S as de}from"./switch-DbAKEeTy.js";import{I as oe}from"./info-DwvPNlM-.js";import{S as me}from"./save-DDGuWeHI.js";import{C as R,a as T}from"./card-D9v-e9xN.js";import{L as xe}from"./layout-grid-t2Dlss5p.js";import{S as he}from"./shield-check-D7PwkRhj.js";import{E as _}from"./eye-DO0kEvpG.js";import"./mockData-Da8oLpbF.js";import"./index-E6ZXw09v.js";import"./index-kT1GkHnk.js";const pe=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],ge=P("calculator",pe);const ue=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],fe=P("list",ue);const je=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ye=P("triangle-alert",je),Ne=({product:i,isOpen:o,onClose:p,onSave:C})=>{const[m,y]=t.useState(30),[d,g]=t.useState(!0);if(t.useEffect(()=>{i&&(y(i.margin||30),g(!0))},[i]),!i)return null;const x=parseFloat(i.supplierPrice),u=(x*(1+m/100)).toFixed(2),M=(u-x).toFixed(2);return e.jsx(te,{open:o,onOpenChange:p,children:e.jsxs(ae,{className:"sm:max-w-[500px]",children:[e.jsxs(re,{children:[e.jsx(ie,{children:"Edit Product Pricing"}),e.jsx(le,{children:"Configure your markup and visibility for this dropshipped product."})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"flex gap-4 p-3 bg-muted rounded-xl border",children:[e.jsx("div",{className:"h-16 w-16 rounded-lg overflow-hidden border bg-background shrink-0",children:e.jsx("img",{src:i.image,alt:i.name,className:"h-full w-full object-cover"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-bold text-sm line-clamp-1",children:i.name}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Supplier ID: SUP-",i.id]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-muted/50 rounded-xl border space-y-1",children:[e.jsx("p",{className:"text-[10px] uppercase font-bold text-muted-foreground",children:"Supplier Price"}),e.jsxs("p",{className:"text-xl font-bold",children:["$",x.toFixed(2)]})]}),e.jsxs("div",{className:"p-4 bg-primary/5 rounded-xl border border-primary/20 space-y-1",children:[e.jsx("p",{className:"text-[10px] uppercase font-bold text-primary italic",children:"Your Selling Price"}),e.jsxs("p",{className:"text-xl font-bold text-primary",children:["$",u]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(V,{className:"font-bold flex items-center gap-2",children:["Markup Percentage: ",e.jsxs("span",{className:"text-primary font-black text-lg",children:[m,"%"]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-[10px] font-medium text-green-600 bg-green-50 px-2 py-0.5 rounded border border-green-100",children:[e.jsx(ge,{className:"h-3 w-3"})," Profit: +$",M]})]}),e.jsx(ce,{value:[m],onValueChange:N=>y(N[0]),max:200,step:1,className:"py-4"}),e.jsxs("div",{className:"flex justify-between text-[10px] text-muted-foreground",children:[e.jsx("span",{children:"0% (Cost price)"}),e.jsx("span",{children:"100% (Double)"}),e.jsx("span",{children:"200% (Triple)"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted/30 rounded-xl border",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(V,{className:"font-bold",children:"Product Visibility"}),e.jsx("p",{className:"text-xs text-muted-foreground text-pretty",children:"Enable this to show product in your storefront."})]}),e.jsx(de,{checked:d,onCheckedChange:g})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-50 dark:bg-blue-950/20 rounded-lg border border-blue-100 dark:border-blue-900/50",children:[e.jsx(oe,{className:"h-4 w-4 text-blue-500 mt-0.5 shrink-0"}),e.jsx("p",{className:"text-[10px] text-blue-700 dark:text-blue-400 leading-normal",children:"Note: This is a dropshipping product. You can only control your margin. Product images and descriptions are managed by the supplier API."})]})]}),e.jsxs(ne,{className:"gap-2 sm:gap-0",children:[e.jsx(l,{variant:"ghost",onClick:p,children:"Cancel"}),e.jsxs(l,{className:"gap-2 px-8",onClick:()=>C({margin:m,isVisible:d}),children:[e.jsx(me,{className:"h-4 w-4"})," Save Changes"]})]})]})})},Re=()=>{const i=q(),{toast:o}=H(),[p,C]=t.useState("products"),[m,y]=t.useState([]),[d,g]=t.useState([]),[x,u]=t.useState([]),[M,N]=t.useState([]),[I,f]=t.useState(!0),[b,F]=t.useState("grid"),[A,O]=t.useState(""),[v,$]=t.useState(""),[n,h]=t.useState(1),[c,B]=t.useState(1),[E,be]=t.useState(null),[Y,z]=t.useState(!1),k=t.useRef(!1),w=t.useRef(!1),D=async()=>{if(!k.current){k.current=!0,f(!0);try{const s=await S.getSupplierProducts({page:n,size:20,keyWord:A,categoryId:v});g(s.products),B(s.totalPages)}catch(s){console.error("Failed to fetch products:",s),o({title:"Error",description:"Failed to fetch products from CJ API.",variant:"destructive"})}finally{f(!1),k.current=!1}}},G=async()=>{if(!w.current){w.current=!0,f(!0);try{const s=await S.fetchCategories();u(s),N(s.map(a=>({id:a.categoryFirstId,name:a.categoryFirstName,subList:a.categoryFirstList,level:1})))}catch(s){console.error("Failed to fetch categories:",s)}finally{f(!1),w.current=!1}}};t.useEffect(()=>{G()},[]),t.useEffect(()=>{D()},[n,v]);const Q=s=>{s.preventDefault(),h(1),D()},L=s=>{i(`/admin/products/${s.id}`)},U=async s=>{try{await S.updateProductMargin(E.id,s.margin),o({title:"Pricing updated",description:"Product markup and visibility saved successfully."}),z(!1)}catch{o({title:"Update failed",description:"There was an error saving pricing settings.",variant:"destructive"})}};return e.jsxs("div",{className:"space-y-6 pb-10",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Supplied Products"}),e.jsx(j,{variant:"outline",className:"bg-indigo-50 text-indigo-700 dark:bg-indigo-900/30 border-indigo-200",children:"API Synced"})]}),e.jsx("p",{className:"text-muted-foreground",children:"Manage markups for products synced from the global dropship network."})]}),p==="products"&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex bg-muted rounded-lg p-1 border",children:[e.jsx(l,{variant:b==="grid"?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:()=>F("grid"),children:e.jsx(xe,{className:"h-4 w-4"})}),e.jsx(l,{variant:b==="list"?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:()=>F("list"),children:e.jsx(fe,{className:"h-4 w-4"})})]})})]}),e.jsx(R,{className:"border-none bg-muted/40 shadow-none",children:e.jsxs(T,{className:"p-4 flex flex-col md:flex-row items-center gap-4",children:[e.jsxs("form",{onSubmit:Q,className:"relative flex-1 w-full",children:[e.jsx(J,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(W,{placeholder:"Search by product name or global ID...",className:"pl-10 bg-background",value:A,onChange:s=>O(s.target.value)}),e.jsx(l,{type:"submit",className:"hidden",children:"Search"})]}),e.jsxs("select",{className:"h-10 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",value:v,onChange:s=>{$(s.target.value),h(1)},children:[e.jsx("option",{value:"",children:"All Categories"}),x.map(s=>e.jsx("optgroup",{label:s.categoryFirstName,children:s.categoryFirstList?.map(a=>e.jsxs(K.Fragment,{children:[e.jsxs("option",{value:a.categorySecondId,children:["-- ",a.categorySecondName]}),a.categorySecondList?.map(r=>e.jsxs("option",{value:r.categoryId,children:["    ",r.categoryName]},r.categoryId))]},a.categorySecondId))},s.categoryFirstId))]})]})}),I&&d.length===0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:Array.from({length:8}).map((s,a)=>e.jsx("div",{className:"h-80 bg-card rounded-xl border animate-pulse"},a))}):e.jsx(X,{children:b==="grid"?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:d.map((s,a)=>e.jsxs(Z.div,{layout:!0,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:a*.05},className:"group relative bg-card rounded-2xl border hover:shadow-xl transition-all overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"aspect-[4/3] relative overflow-hidden bg-muted",children:[e.jsx("img",{src:s.image,alt:s.name,className:"h-full w-full object-cover transition-transform group-hover:scale-105"}),e.jsxs("div",{className:"absolute top-2 right-2 flex flex-col gap-1",children:[e.jsxs(j,{className:"bg-green-500 hover:bg-green-600 border-none",children:["In Stock: ",s.stock]}),e.jsx(j,{variant:"secondary",className:"backdrop-blur-md bg-white/50 border-white/20",children:s.category})]})]}),e.jsxs("div",{className:"p-5 flex-1 flex flex-col gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"font-bold text-sm line-clamp-2 min-h-[2.5rem] leading-tight",children:s.name}),e.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] text-muted-foreground",children:[e.jsx(he,{className:"h-3 w-3 text-indigo-500"}),"Verified Supplier"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 p-3 bg-muted/50 rounded-xl border border-muted-foreground/10 text-xs",children:[e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{className:"text-[10px] text-muted-foreground uppercase font-bold tracking-tighter",children:"Supplier Price"}),e.jsxs("span",{className:"font-medium text-muted-foreground",children:["₹",s.supplierPrice]})]}),e.jsxs("div",{className:"flex flex-col gap-0.5 border-l pl-3 border-muted-foreground/20",children:[e.jsx("span",{className:"text-[10px] text-primary uppercase font-bold tracking-tighter italic",children:"Your Price"}),e.jsxs("span",{className:"font-bold text-primary",children:["₹",s.price]})]})]}),e.jsxs("div",{className:"mt-auto pt-2 flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] text-muted-foreground font-medium",children:"Profit Margin"}),e.jsxs("span",{className:"text-xs font-bold text-green-600",children:["+",s.margin,"%"]})]}),e.jsxs(l,{size:"sm",className:"gap-2 rounded-full px-4",onClick:()=>L(s),children:[e.jsx(_,{className:"h-3 w-3"})," View Product"]})]})]})]},s.id))}):e.jsx(R,{children:e.jsx(T,{className:"p-0",children:e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-muted/30",children:[e.jsx("th",{className:"h-12 px-6 text-left align-middle font-medium text-muted-foreground",children:"Product"}),e.jsx("th",{className:"h-12 px-6 text-left align-middle font-medium text-muted-foreground",children:"Category"}),e.jsx("th",{className:"h-12 px-6 text-left align-middle font-medium text-muted-foreground",children:"Supplier Cost"}),e.jsx("th",{className:"h-12 px-6 text-left align-middle font-medium text-muted-foreground",children:"Markup"}),e.jsx("th",{className:"h-12 px-6 text-left align-middle font-medium text-muted-foreground text-primary font-bold italic",children:"Selling Price"}),e.jsx("th",{className:"h-12 px-6 text-right align-middle font-medium text-muted-foreground",children:"Stock"}),e.jsx("th",{className:"h-12 px-6 text-right align-middle font-medium text-muted-foreground",children:"Actions"})]})}),e.jsx("tbody",{children:d.map((s,a)=>e.jsxs("tr",{className:"border-b hover:bg-muted/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded border overflow-hidden shrink-0",children:e.jsx("img",{src:s.image,className:"h-full w-full object-cover"})}),e.jsx("span",{className:"font-medium line-clamp-1 max-w-[200px]",children:s.name})]})}),e.jsx("td",{className:"px-6 py-4 text-xs",children:s.category}),e.jsxs("td",{className:"px-6 py-4 text-muted-foreground",children:["₹",s.supplierPrice]}),e.jsxs("td",{className:"px-6 py-4 text-green-600 font-medium",children:["+",s.margin,"%"]}),e.jsxs("td",{className:"px-6 py-4 font-bold text-primary",children:["₹",s.price]}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx(j,{variant:s.stock>10?"outline":"destructive",className:"rounded-full",children:s.stock})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx(l,{variant:"ghost",size:"icon",className:"h-8 w-8 text-indigo-600",onClick:()=>L(s),children:e.jsx(_,{className:"h-4 w-4"})})})]},s.id))})]})})})})}),!I&&c>1&&e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-8",children:[e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>h(s=>Math.max(1,s-1)),disabled:n===1,children:[e.jsx(ee,{className:"h-4 w-4 mr-1"})," Previous"]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,c)}).map((s,a)=>{let r;return c<=5||n<=3?r=a+1:n>=c-2?r=c-4+a:r=n-2+a,e.jsx(l,{variant:n===r?"primary":"outline",size:"sm",className:"h-8 w-8 p-0",onClick:()=>h(r),children:r},r)})}),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>h(s=>Math.min(c,s+1)),disabled:n===c,children:["Next ",e.jsx(se,{className:"h-4 w-4 ml-1"})]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-4 py-8 opacity-40 hover:opacity-100 transition-opacity",children:[e.jsx(ye,{className:"h-5 w-5"}),e.jsx("p",{className:"text-xs max-w-lg text-center font-medium",children:"As a dropshipping platform, product details are automatically managed by the supplier API. V-COMMERCE admins can only control markup percentages and storefront visibility."})]}),e.jsx(Ne,{product:E,isOpen:Y,onClose:()=>z(!1),onSave:U})]})};export{Re as default};
