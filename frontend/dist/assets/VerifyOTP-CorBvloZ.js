import{r as c,O as N,E as w,j as e,m as k,B as C,af as x}from"./index-DEuHK2Q3.js";import{S}from"./shield-check-D7PwkRhj.js";import{L as O}from"./loader-circle-BsbfwBNe.js";import{A as P}from"./arrow-right-jo4rUUB6.js";import{A as T}from"./arrow-left-C4Dyo6zU.js";import{R}from"./refresh-cw-rvDILOcz.js";const B=()=>{const[i,l]=c.useState(["","","","","",""]),[r,d]=c.useState(60),[u,m]=c.useState(!1),o=c.useRef([]),f=N(),{toast:n}=w();c.useEffect(()=>{let t;return r>0&&(t=setInterval(()=>d(r-1),1e3)),()=>clearInterval(t)},[r]);const g=(t,s)=>{if(isNaN(s))return;const a=[...i];a[t]=s.substring(s.length-1),l(a),s&&t<5&&o.current[t+1].focus()},h=(t,s)=>{s.key==="Backspace"&&!i[t]&&t>0&&o.current[t-1].focus()},y=t=>{t.preventDefault();const s=t.clipboardData.getData("text").substring(0,6).split(""),a=[...i];s.forEach((p,j)=>{isNaN(p)||(a[j]=p)}),l(a),s.length>0&&o.current[Math.min(s.length,5)].focus()},b=async t=>{t.preventDefault();const s=i.join("");if(s.length<6){n({title:"Incomplete Code",description:"Please enter all 6 digits.",variant:"destructive"});return}m(!0);try{await x.verifyOTP(s),n({title:"Verification Successful",description:"Your account is now fully active!"}),f("/")}catch(a){n({title:"Verification Failed",description:a.message||"Invalid OTP code. Try 123456",variant:"destructive"})}finally{m(!1)}},v=async()=>{const t=localStorage.getItem("pending_email");if(!t){n({title:"Error",description:"Email not found. Please signup again.",variant:"destructive"});return}try{await x.resendOTP(t),d(60),l(["","","","","",""]),o.current[0].focus(),n({title:"OTP Resent",description:"A new verification code has been sent to your email."})}catch(s){n({title:"Error",description:s.message||"Failed to resend OTP.",variant:"destructive"})}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-muted/30 p-4",children:e.jsxs(k.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"w-full max-w-md bg-card border rounded-3xl p-8 shadow-2xl space-y-8",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("div",{className:"h-16 w-16 bg-indigo-100 dark:bg-indigo-900/30 rounded-2xl flex items-center justify-center mx-auto mb-4 text-indigo-600 dark:text-indigo-400",children:e.jsx(S,{className:"h-8 w-8"})}),e.jsx("h1",{className:"text-3xl font-black tracking-tight",children:"Verify Your Account"}),e.jsxs("p",{className:"text-muted-foreground text-sm font-medium",children:["We've sent a 6-digit verification code to ",e.jsx("br",{}),e.jsx("span",{className:"font-bold text-foreground",children:localStorage.getItem("pending_email")||"your email address"})]})]}),e.jsxs("form",{onSubmit:b,className:"space-y-8",children:[e.jsx("div",{className:"flex justify-between gap-2 max-w-sm mx-auto",children:i.map((t,s)=>e.jsx("input",{ref:a=>o.current[s]=a,type:"text",inputMode:"numeric",maxLength:1,value:t,onChange:a=>g(s,a.target.value),onKeyDown:a=>h(s,a),onPaste:y,className:"w-full h-14 text-center text-2xl font-black rounded-xl border bg-background focus:ring-2 focus:ring-primary focus:border-primary transition-all outline-none"},s))}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(C,{type:"submit",className:"w-full h-12 rounded-xl font-bold bg-primary hover:bg-primary/90 transition-all gap-2",disabled:u,children:u?e.jsx(O,{className:"h-5 w-5 animate-spin"}):e.jsxs(e.Fragment,{children:["Verify & Continue ",e.jsx(P,{className:"h-5 w-5"})]})}),e.jsxs("div",{className:"flex items-center justify-between px-2",children:[e.jsxs("button",{type:"button",onClick:()=>f("/signup"),className:"flex items-center gap-1 text-xs font-bold text-muted-foreground hover:text-primary transition-colors",children:[e.jsx(T,{className:"h-3 w-3"})," Change Details"]}),e.jsxs("button",{type:"button",onClick:v,disabled:r>0,className:"flex items-center gap-1 text-xs font-bold text-primary disabled:text-muted-foreground hover:underline transition-all",children:[e.jsx(R,{className:`h-3 w-3 ${r>0?"":"animate-spin-once"}`}),r>0?`Resend Code in ${r}s`:"Resend Code Now"]})]})]})]}),e.jsxs("div",{className:"p-4 bg-muted/50 rounded-2xl text-center space-y-1",children:[e.jsx("p",{className:"text-[10px] uppercase font-black tracking-widest text-muted-foreground opacity-60",children:"Security Tip"}),e.jsx("p",{className:"text-xs text-muted-foreground leading-relaxed",children:"Never share your OTP with anyone. V-Commerce will never call you asking for your verification code."})]})]})})};export{B as default};
